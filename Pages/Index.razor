@page "/"
@using DigitalNetWeb.Data.Models;
@using DigitalNetWeb.Data.ModelService;

<head>
    <link rel="shortcut icon" type="image/ico" href="/favicon.ico" />
    <link rel="icon" type="image/ico" href="/favicon.ico" />
    <link rel="apple-touch-icon" type="image/ico" href="/favicon.ico" />

</head>

<div>
    <div class="input-group">
        <div class="form-outline">
            <input type="input" class="form-control" id="inputSearch" placeholder="Search">
        </div>
        <button type="button" class="btn btn-primary">
            <i class="oi oi-magnifying-glass"></i>
        </button>
    </div>
</div>

<br>

@if (Digimonlist == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="container">
        <div class="item-wrapper">
            @for (int i = @StartLoop; i < @EndLoop; i++)
            {
                Digimon digimon = Digimonlist[i];
                <SearchCard ob=@digimon name=@digimon.EngName icon=@digimon.IconLink />
            }
        </div>

    </div>
}

<div class="container">
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-end">
            <li class="page-item disabled">
                <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">Next</a>
            </li>
        </ul>
    </nav>
</div>

@code {
    private Digimon[]? Digimonlist;
    private int PageIndex = 0;
    private int TotalPages = 0;
    private int IconsPerPage = 150; // number of icons you want shown on each page
    private int StartLoop = 0;
    private int EndLoop = 0;
    protected override async Task OnInitializedAsync()
    {
        Digimonlist = await new DigimonService().GetDigimonDBAsync();
        TotalPages = (Digimonlist.Length - 1) / (IconsPerPage + 1);
        EndLoop = Math.Min(((PageIndex * IconsPerPage) + IconsPerPage + PageIndex), Digimonlist.Length - 1);
    }

    private void reloadPage(int page)
    {
        PageIndex = page;
        StartLoop = PageIndex * IconsPerPage;
        EndLoop = Math.Min(((PageIndex * IconsPerPage) + IconsPerPage + PageIndex), Digimonlist.Length - 1);
    }

    private string generateID(int id)
    {
        Console.WriteLine("P" + id);
        return "P" + id;
    }
}
